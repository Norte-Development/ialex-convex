# Document Processor Environment Variables

# Server Configuration
PORT=4001

# Redis Configuration
REDIS_URL=redis://localhost:6379

# OpenAI Configuration
OPENAI_API_KEY=your_openai_api_key_here
EMBEDDING_MODEL=text-embedding-3-small
EMBED_DIM=1536

# Qdrant Configuration
QDRANT_URL=http://localhost:6333
QDRANT_API_KEY=your_qdrant_api_key_here
QDRANT_COLLECTION=ialex_documents
QDRANT_LIBRARY_COLLECTION=ialex_library_documents

# Mistral Configuration
MISTRAL_API_KEY=your_mistral_api_key_here
MISTRAL_OCR_ENDPOINT=https://api.mistral.ai/v1/ocr

# Deepgram Configuration (for audio/video transcription)
DEEPGRAM_API_KEY=your_deepgram_api_key_here

# Security
HMAC_SECRET=your_hmac_secret_here

# Worker Configuration
WORKER_CONCURRENCY=2

# Timeout Configuration (in milliseconds)
FILE_VALIDATION_TIMEOUT_MS=30000
FILE_DOWNLOAD_TIMEOUT_MS=600000
OCR_REQUEST_TIMEOUT_MS=900000
TRANSCRIPTION_REQUEST_TIMEOUT_MS=1200000
EXTRACTION_PROCESSING_TIMEOUT_MS=600000
CHUNKING_PROCESSING_TIMEOUT_MS=120000
EMBEDDING_REQUEST_TIMEOUT_MS=300000
QDRANT_UPSERT_TIMEOUT_MS=60000

# Deepgram Configuration
DEEPGRAM_MAX_CONCURRENT=10
DEEPGRAM_REQUEST_TIMEOUT_MS=300000

# Error Handling
MAX_CONCURRENT_OCR_REQUESTS=3

# Streaming Configuration
USE_STREAMING_PROCESSOR=false       # Enable streaming pipeline
TEMP_DIR=/tmp/document-processor
STREAMING_CHUNK_SIZE_MB=10          # Size of streaming chunks
STREAMING_PDF_PAGE_WINDOW=20        # Process PDFs in batches of N pages
STREAMING_EMBED_BATCH=20            # Embed and upsert every N chunks
STREAMING_AUTO_CLEANUP=true         # Clean up temp files after success

# Resume Configuration
ENABLE_JOB_RESUME=true
JOB_STATE_TTL_DAYS=7                # How long to keep job state in Redis
TEMP_FILES_TTL_HOURS=48             # Cleanup temp files after N hours
MAX_RESUME_ATTEMPTS=3               # Don't resume after N failed attempts
CHECKPOINT_INTERVAL_MS=5000         # Save state every N ms

# Cleanup Configuration
AUTO_CLEANUP_ON_SUCCESS=true
AUTO_CLEANUP_ON_FAILURE=false       # Keep files for manual inspection

# Memory Limits
MAX_HEAP_SIZE_MB=3500               # Alert if heap exceeds this
